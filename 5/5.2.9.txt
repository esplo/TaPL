elseの項が先に評価されてしまうと発散してしまうため、
評価順を規則で固定できる通常のifを使った